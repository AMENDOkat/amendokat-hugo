{{ define "main" }}
<style>
    ul{
        list-style-type: none;
    }

    .item-details{
        margin-left: 0.8rem;
    }

    .item-title, .item-cap, .item-stats{
        display: block;
    }

    .item-title{
        font-size: 1.1rem;
    }

    .item-stats{
        color: var(--grey);
    }

    .posts{
        border: var(--border-1);
        margin: 1rem 0 1rem 0;
    }

    .post-top-section{
        padding: 1rem;
        border-bottom: 1px dotted var(--grey);
    }

    .post-title{
        font-weight: bold;
    }

    .posts h2{
        background-color: transparent;
        color: var(--off-white);
        padding-left: 1rem;
        margin: 0.5rem 0 0.5rem 0;
    }

    .main-container li{
        border: var(--border-1);
        padding: 5px 5px 1px 5px;
        display: flex;
    }

    @media screen and (max-width: 696px){
        .posts{
            border-width: 1px 0 1px 0;
        }        

        .main-container li{
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border: none;
            border-bottom: var(--border-1);
            padding-bottom: 0.5rem;
        }

        li img{
            width: 13rem;
        }
    }
</style>

<div class="main-container">
    <h1>{{ .Title }}</h1>
    <hr>
    {{ .Content }}
    <ul>
        {{ range .Pages }}
        {{ $type := .Param "type" }}
        {{ $date := .Date.Format "Jan 02 2006" }}
        {{ $lastmod := .Lastmod.Format "Jan 02 2006" }}
        
            {{ if eq $type "post" }}
                <div class="posts">
                    <div class="post-top-section">
                    <span class="post-title">{{ .Title }}</span>
                    <span class="item-stats">
                        Published {{ $date }}
                        <!-- If "date" (Published) is different from "lastmod" (Last Modified) display last modified info, if not, display nothing -->
                        {{ if ne $date $lastmod }}
                            | Last Modified {{ $lastmod }}
                        {{ end }}
                    </span>
                    </div>
                    <span>{{ .Content }}</span>
                </div>
            
            {{ else }}
                <li>
                    <!-- Check if "cover" is available on frontmatter, if not, display chickens -->
                    {{ if .Params.cover }}
                        {{  with resources.GetRemote .Params.cover  }}
                            {{ with . }}
                                <picture>
                                    {{ $desktop := .Resize "100x webp q70" }}
                                    {{ $mobile := .Resize "208x webp q70" }}
                                    <source 
                                    type="image/webp"
                                    media="(max-width: 696px)"
                                    srcset="{{ $mobile.RelPermalink }}"
                                    width="{{ $mobile.Width }}"
                                    height="{{ $mobile.Height }}"
                                    />
                                    <source 
                                    type="image/webp"
                                    media="(min-width: 697px)"
                                    srcset="{{ $desktop.RelPermalink }}"
                                    width="{{ $desktop.Width }}"
                                    height="{{ $desktop.Height }}"
                                    />
                                    <img src="{{ $desktop.RelPermalink }}" alt="" width="{{ $desktop.Width }}" height="{{ $desktop.Height }}" loading="lazy">
                                </picture>
                            {{ end }}
                        {{ end }}
                    {{ else }}
                        <img src='{{ relURL "images/chicken.webp" }}' alt="" width="100px" height="100px">
                    {{ end }}

                    <div class="item-details">
                        <a class="item-title" href="{{ .RelPermalink }}">{{ .LinkTitle }}</a>
                        <!-- Check if "caption" is available on frontmatter, if not, check for "description", if description also isn't available, display summary  -->
                        {{ if .Params.caption }}
                            <span class="item-cap">{{ .Params.caption }}</span>
                        {{ else if .Description }}
                            <span class="item-cap">{{ .Description }}</span>
                        {{ else }}
                        <span class="item-cap">{{ .Summary }}</span>
                        {{ end }}
                            <!-- Check if frontmatter type matches "artwork", displays information about file -->
                            {{ if eq $type "artwork" }}
                                {{ range .Params.art_tags }}
                                    <a class="tags" href='/art_tags/{{ . | urlize }}'>#{{ . }}</a>
                                {{ end }}
                                <span class="item-stats">
                                    Created {{ .Params.created | time.Format ":date_medium" }} | Published {{ $date }}
                                    <!-- If "date" (Published) is different from "lastmod" (Last Modified) display last modified info, if not, display nothing -->
                                    {{ if ne $date $lastmod }}
                                        | Last Modified {{ $lastmod }}
                                    {{ end }}
                                </span>
                            <!-- If frontmatter type doesn't match any of the specified values, display chickens -->
                            {{ else }}
                                <i style="color: var(--grey);">nothing here but us chickens!</i>
                            {{ end }}
                        </span>
                    </div>
                </li>
            {{ end }}
        {{ end }}
    </ul>
</div>
{{ end }}